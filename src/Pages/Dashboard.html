<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard | Welcome to The Indian Summit</title>
    <!-- Insert site logo -->
    <link
      rel="shortcut icon"
      href="../images/Homepage/Logo.png"
      type="image/x-icon"
    />
    <!-- Insert site stylesheet -->
    <link rel="stylesheet" href="../css/styles.css" />
    <!-- Tailwind CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #1a1a1a;
        color: #fff;
      }

      .dashboard-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
      }

      .dashboard-header h1 {
        color: rgb(233, 86, 19);
      }

      .stats {
        display: grid;
        /* grid-template-columns: repeat(3, 1fr); */
        gap: 20px;
        margin-bottom: 30px;
      }

      .stats .card {
        background-color: #2a2a2a;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .stats .card h2 {
        margin: 10px 0;
        font-size: 24px;
        color: rgb(233, 86, 19);
      }

      .stats .card p {
        font-size: 18px;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      .user-list {
        background-color: #2a2a2a;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .user-list table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      .user-list th,
      .user-list td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid #555;
      }

      .user-list th {
        background-color: rgb(233, 86, 19);
        color: #fff;
      }

      .user-list tr:hover {
        background-color: #444;
      }
      .table-container {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }

      .table-container th,
      .table-container td {
        padding: 8px;
        text-align: left;
        border: 2px solid #201b1b4a;
      }
      @media (max-width: 768px) {
        .stats {
          grid-template-columns: 1fr;
          gap: 10px;
        }

        .stats .card {
          padding: 15px;
        }

        .stats .card h2 {
          font-size: 20px;
        }

        .stats .card p {
          font-size: 16px;
        }

        .user-list {
          padding: 15px;
        }
        .user-list th,
        .user-list td {
          padding: 8px;
          font-size: 14px;
        }

        .user-list table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header Begin -->
    <header id="header">
      <div class="logo">
        <a href="../../index.html"
          ><img src="../images/Homepage/Logo.png" alt="logo"
        /></a>
      </div>
      <nav id="nav">
        <ul>
          <li><a id="active" href="../../index.html">Home</a></li>
          <li>
            <a href="../Pages/Committee&Agenda.html"
              >Committees and Agendas
              <i class="fas fa-angle-down"></i>
            </a>
          </li>
          <!-- <li>
                    <a href="#">Our Organisation
                        <i class='fas fa-angle-down'></i>
                    </a>
                    <ul id="Our_Organisation">
                        <li><a href="#">Secretariat</a></li>
                        <li><a href="#">Memories</a></li>
                        <li><a href="#">Mahila Sashaktikaran Avam Rastra Nirmarn</a></li>
                    </ul>
                </li>
                <li><a href="#">Collabrations and Sponsors </a></li>
                <li><a href="#">Events</a></li> -->
                <li><a href="../Pages/MRN.html">Mahila Sashaktikaran Avam Rastra Nirmarn</a></li>
          <li>
            <a href="#"
              >About Us
              <i class="fas fa-angle-down"></i>
            </a>
            <ul id="about">
              <li>
                <a href="../Pages/Introduction.html"
                  >Introduction to The Indian Summit</a
                >
              </li>
              <li>
                <a href="../Pages/Theme.html">Theme of The Indian Summit 24</a>
              </li>
              <li><a href="../Pages/Profile.html">Meet the Secretariat</a></li>
            </ul>
          </li>
          <!-- <li><a href="#">Schedule</a></li> -->
          <li><a href="../Pages/Contact Us.html">Contact Us</a></li>
        </ul>
      </nav>
      <a href="../Pages/Registration.html">
        <button id="Register_button">Register Now</button>
      </a>
      <div id="hamburger">&#9776;</div>
      <div id="cross">&times;</div>
    </header>
    <!-- Header End-->

    <!-- Dashboard Begin -->
    <div id="dashboard" class="dashboard-container">
      <div class="dashboard-header">
        <h1>Admin Dashboard</h1>
        <!-- <a href="../Pages/Application-Form.html">
          <button class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">
            Application Form
          </button>
        </a> -->
      </div>

      <!-- User Counts -->
      <div class="stats">
        <!-- <div class="card">
                <h2 class="text-xl">Total Users</h2>
                <p id="userCount" >0</p>
            </div> -->
        <div class="card">
          <h2 class="text-xl">Registered Users</h2>
          <p id="registeredUsers">0</p>
        </div>
        <!-- <div class="card">
                <h2 class="text-xl">Users Registered Today</h2>
                <p id="usersToday" >0</p>
            </div> -->
      </div>

      <!-- User List -->
      <div class="user-list">
        <h2>Registered Users</h2>
        <input
          style="color: black; padding: 8px; border-radius: 7px"
          type="text"
          id="searchInput"
          placeholder="Search..."
        />
        <button
          style="
            background-color: rgb(233, 86, 19);
            padding: 8px;
            border-radius: 10px;
          "
          id="searchButton"
        >
          Search
        </button>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Participant's Name</th>
                <th>Institution Name</th>
                <th>Phone No.</th>
                <th>Optional Phone No.</th>
                <th>Age</th>
                <th>Mail Id</th>
                <th>Committee Preference-1</th>
                <th>Committee Preference-2</th>
                <th>Portfolio Preference-1</th>
                <th>Portfolio Preference-2</th>
                <th>Prior Mun Experience</th>
                <th>Accommodation</th>
                <th>Transaction ID</th>
                <th>Referred by</th>
              </tr>
            </thead>
            <tbody id="userList">
              <!-- User details will be dynamically inserted here -->
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- Dashboard End -->

    <!-- Footer Begin -->
    <footer class="mt-10">
      <div class="container">
        <div class="item-1">
          <h1 class="heading" style="color: rgb(255, 255, 255)">Contact us</h1>
          <a href="tel:+918958836666" style="color: rgb(255, 255, 255)"
            >Phone: +918958836666</a
          ><br />
          <a
            href="mailto:info@theindiansummit.com"
            style="color: rgb(255, 255, 255)"
            >Email: info@theindiansummit.com</a
          >
          <br />
          <div
            style="
              margin-top: 20px;
              display: flex;
              flex-direction: row;
              gap: 10px;
            "
          >
            <a
              href="https://www.instagram.com/theindiansummit?igsh=a2IxdHI2dW84MG92"
              target="_blank"
              style="margin-right: 10px"
            >
              <img
                src="../images/Footer/instagram.png"
                alt=""
                width="25"
                height="25"
              />
            </a>
            <a
              href="https://www.linkedin.com/company/the-indian-summit/"
              target="_blank"
              style="margin-right: 10px"
            >
              <img
                src="../images/Footer/linkedin.png"
                alt=""
                width="25px"
                height="25px"
              />
            </a>
            <a
              href="https://wa.me/917665999929?text=Hello%20I%20have%20a%20query"
              target="_blank"
              style="margin-right: 10px"
            >
              <img
                src="../images/Footer/whatsapp.png"
                alt=""
                width="25px"
                height="25px"
              />
            </a>
          </div>
        </div>
        <div class="item-2">
          <a href="../Pages/Registration.html">Register</a>
        </div>
      </div>
    </footer>
    <!-- Footer End -->

    <!-- JavaScript to Dynamically Update Dashboard -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        getDocs,
      } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD2uPHIXx_hwpF3zXR2eNu7jqczvvu8MQY",
        authDomain: "theindiansummit-98ffa.firebaseapp.com",
        projectId: "theindiansummit-98ffa",
        storageBucket: "theindiansummit-98ffa.appspot.com",
        messagingSenderId: "241244760650",
        appId: "1:241244760650:web:d576bad57b3d07f66454b3",
        measurementId: "G-4723RZ1TB6",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      async function fetchRegisteredPeople() {
        const querySnapshot = await getDocs(
          collection(db, "eventRegistrations")
        );
        const registeredPeople = [];

        querySnapshot.forEach((doc) => {
          registeredPeople.push({ id: doc.id, ...doc.data() });
        });

        return registeredPeople;
      }

      function displayRegisteredPeople(people) {
        const userList = document.getElementById("userList");
        userList.innerHTML = ""; // Clear existing entries

        people.forEach((person) => {
          const tableRow = document.createElement("tr");

          const nameCell = document.createElement("td");
          nameCell.textContent = person.name;

          const institutionCell = document.createElement("td");
          institutionCell.textContent = person.institution;

          const phoneCell = document.createElement("td");
          phoneCell.textContent = person.contact;

          const optionalPhoneCell = document.createElement("td");
          optionalPhoneCell.textContent = person.parentContact;

          const ageCell = document.createElement("td");
          ageCell.textContent = person.age;

          const mailCell = document.createElement("td");
          mailCell.textContent = person.email;

          const committee1Cell = document.createElement("td");
          committee1Cell.textContent = person.committee1;

          const committee2Cell = document.createElement("td");
          committee2Cell.textContent = person.committee2;

          const portfolio1Cell = document.createElement("td");
          portfolio1Cell.textContent = person.portfolio1;

          const portfolio2Cell = document.createElement("td");
          portfolio2Cell.textContent = person.portfolio2;

          const priorMunCell = document.createElement("td");
          priorMunCell.textContent = person.experience;

          const accommodationCell = document.createElement("td");
          accommodationCell.textContent = person.accommodation;

          const transactionIdCell = document.createElement("td");
          transactionIdCell.textContent = person.transactionId;

          const referByCell = document.createElement("td");
          referByCell.textContent = person.referBy;

          tableRow.appendChild(nameCell);
          tableRow.appendChild(institutionCell);
          tableRow.appendChild(phoneCell);
          tableRow.appendChild(optionalPhoneCell);
          tableRow.appendChild(ageCell);
          tableRow.appendChild(mailCell);
          tableRow.appendChild(committee1Cell);
          tableRow.appendChild(committee2Cell);
          tableRow.appendChild(portfolio1Cell);
          tableRow.appendChild(portfolio2Cell);
          tableRow.appendChild(priorMunCell);
          tableRow.appendChild(accommodationCell);
          tableRow.appendChild(transactionIdCell);
          tableRow.appendChild(referByCell);

          userList.appendChild(tableRow);
        });
      }

      async function applySearch() {
        const searchInput = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const registeredPeople = await fetchRegisteredPeople();

        const filteredPeople = registeredPeople.filter((person) =>
          Object.values(person).some((value) =>
            String(value).toLowerCase().includes(searchInput)
          )
        );

        filteredPeople.sort((a, b) => b.transactionId - a.transactionId);
        displayRegisteredPeople(filteredPeople);
      }

      document.addEventListener("DOMContentLoaded", async () => {
        const registeredPeople = await fetchRegisteredPeople();
        const registeredUsers = document.getElementById("registeredUsers");
        registeredUsers.textContent = registeredPeople.length;

        displayRegisteredPeople(registeredPeople);

        document
          .getElementById("searchButton")
          .addEventListener("click", applySearch);
      });

      let header = document.getElementById("header");
      let nav = document.getElementById("nav");
      let ham = document.getElementById("hamburger");
      let cross = document.getElementById("cross");

      ham.addEventListener("click", () => {
        ham.style.display = "none";
        cross.style.display = "block";
        header.style.backgroundColor = "black";
        if (nav.classList != "show") {
          nav.style.zIndex = "9999";
          nav.classList.add("show");
        }
      });

      cross.addEventListener("click", () => {
        ham.style.display = "block";
        cross.style.display = "none";
        header.style.backgroundColor = "transparent";
        if (nav.classList == "show") {
          nav.classList.remove("show");
        }
      });
    </script>
  </body>
</html>
